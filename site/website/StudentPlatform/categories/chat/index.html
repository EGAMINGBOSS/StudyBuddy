<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Community Chat - Student Hub</title>
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">

<style>
* { margin:0; padding:0; box-sizing:border-box; }
body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg,#667eea 0%,#764ba2 100%); height:100vh; overflow:hidden; }
.back-btn { position: fixed; top:20px; left:20px; background:white; color:#667eea; border:none; padding:12px 25px; border-radius:25px; font-weight:bold; cursor:pointer; box-shadow:0 4px 15px rgba(0,0,0,0.2); z-index:1000; transition:0.3s; }
.back-btn:hover { transform:translateY(-3px); box-shadow:0 6px 20px rgba(0,0,0,0.3); }
.chat-container { display:flex; height:calc(100vh - 40px); margin:20px; margin-top:80px; background:white; border-radius:30px; overflow:hidden; box-shadow:0 20px 60px rgba(0,0,0,0.3); }
.sidebar { width:300px; background:#f8f9fa; border-right:1px solid #e0e0e0; display:flex; flex-direction:column; }
.sidebar-header { padding:25px; background:linear-gradient(135deg,#667eea 0%,#764ba2 100%); color:white; }
.sidebar-header h2 { font-size:1.5rem; margin-bottom:10px; }
.online-count { font-size:0.9rem; opacity:0.9; }
.room-list { flex:1; overflow-y:auto; padding:15px; }
.room-item { padding:15px; margin-bottom:10px; background:white; border-radius:15px; cursor:pointer; transition:0.3s; border:2px solid transparent; }
.room-item:hover { transform:translateX(5px); border-color:#667eea; }
.room-item.active { background:linear-gradient(135deg,#667eea 0%,#764ba2 100%); color:white; }
.room-name { font-weight:bold; margin-bottom:5px; display:flex; align-items:center; gap:10px; }
.room-members { font-size:0.85rem; opacity:0.7; }
.chat-area { flex:1; display:flex; flex-direction:column; }
.chat-header { padding:25px; background:white; border-bottom:1px solid #e0e0e0; display:flex; justify-content:space-between; align-items:center; }
.chat-title { font-size:1.5rem; font-weight:bold; color:#333; }
.chat-actions { display:flex; gap:10px; }
.action-btn { width:40px; height:40px; border-radius:50%; border:none; background:#f0f0f0; cursor:pointer; display:flex; align-items:center; justify-content:center; transition:0.3s; }
.action-btn:hover { background:#667eea; color:white; transform:scale(1.1); }
.messages-container { flex:1; overflow-y:auto; padding:25px; background:#f8f9fa; }
.message { display:flex; margin-bottom:20px; animation:slideIn 0.3s; }
@keyframes slideIn { from {opacity:0; transform:translateY(10px);} to {opacity:1; transform:translateY(0);} }
.message.own { flex-direction:row-reverse; }
.message-avatar { width:40px; height:40px; border-radius:50%; background:linear-gradient(135deg,#667eea 0%,#764ba2 100%); display:flex; align-items:center; justify-content:center; color:white; font-weight:bold; margin:0 10px; }
.message-content { max-width:60%; }
.message-header { display:flex; align-items:center; gap:10px; margin-bottom:5px; }
.message-author { font-weight:bold; color:#333; }
.message-time { font-size:0.8rem; color:#999; }
.message-bubble { padding:12px 18px; border-radius:18px; background:white; box-shadow:0 2px 5px rgba(0,0,0,0.05); }
.message.own .message-bubble { background:linear-gradient(135deg,#667eea 0%,#764ba2 100%); color:white; }
.input-area { padding:20px; background:white; border-top:1px solid #e0e0e0; }
.input-container { display:flex; gap:10px; align-items:center; }
.message-input { flex:1; padding:15px 20px; border:2px solid #e0e0e0; border-radius:25px; font-size:1rem; }
.message-input:focus { outline:none; border-color:#667eea; }
.send-btn { width:50px; height:50px; border-radius:50%; border:none; background:linear-gradient(135deg,#667eea 0%,#764ba2 100%); color:white; display:flex; align-items:center; justify-content:center; cursor:pointer; transition:0.3s; }
.send-btn:hover { transform:scale(1.1); box-shadow:0 5px 20px rgba(102,126,234,0.4); }
.online-users { width:250px; background:#f8f9fa; border-left:1px solid #e0e0e0; padding:20px; overflow-y:auto; }
.online-users h3 { color:#667eea; margin-bottom:20px; font-size:1.2rem; }
.user-item { display:flex; align-items:center; gap:10px; padding:10px; margin-bottom:10px; background:white; border-radius:10px; cursor:pointer; transition:0.3s; }
.user-item:hover { transform:translateX(-5px); box-shadow:0 3px 10px rgba(0,0,0,0.1); }
.user-avatar { width:35px; height:35px; border-radius:50%; background:linear-gradient(135deg,#43e97b 0%,#38f9d7 100%); display:flex; align-items:center; justify-content:center; color:white; font-weight:bold; position:relative; }
.online-indicator { width:10px; height:10px; background:#43e97b; border-radius:50%; position:absolute; bottom:0; right:0; border:2px solid white; }
.user-name { font-weight:600; color:#333; }
@media(max-width:768px){.sidebar{width:250px;}.online-users{display:none;}.message-content{max-width:80%;}}
</style>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

</head>
<body>
<button class="back-btn" onclick="window.location.href='../../index.html'">
    <i class="fas fa-arrow-left"></i> Back to Home
</button>

<div class="chat-container">
    <!-- Sidebar -->
    <div class="sidebar">
        <div class="sidebar-header">
            <h2><i class="fas fa-comments"></i> Chat Rooms</h2>
            <div class="online-count">
                <i class="fas fa-circle" style="color: #43e97b; font-size:0.6rem;"></i>
                <span id="onlineCount">0 online</span>
            </div>
        </div>
        <div class="room-list">
            <div class="room-item active" onclick="switchRoom('general')"><div class="room-name"><i class="fas fa-hashtag"></i> General</div><div class="room-members">0 members</div></div>
            <div class="room-item" onclick="switchRoom('random')"><div class="room-name"><i class="fas fa-random"></i> Random</div><div class="room-members">0 members</div></div>
        </div>
    </div>

    <!-- Chat Area -->
    <div class="chat-area">
        <div class="chat-header">
            <div>
                <div class="chat-title" id="roomTitle"># General</div>
                <div style="color:#999;font-size:0.9rem;">Welcome to the chat!</div>
            </div>
        </div>

        <div class="messages-container" id="messagesContainer">
            <div style="text-align:center;padding:40px;color:#999;">Loading messages...</div>
        </div>

        <div class="input-area">
            <div class="input-container">
                <input type="text" class="message-input" id="messageInput" placeholder="Type a message..." onkeypress="if(event.key==='Enter') sendMessage()">
                <button class="send-btn" onclick="sendMessage()"><i class="fas fa-paper-plane"></i></button>
            </div>
        </div>
    </div>

    <!-- Online Users -->
    <div class="online-users">
        <h3><i class="fas fa-users"></i> Online Now</h3>
        <div id="onlineUsersList"></div>
    </div>
</div>

<script>
  // ðŸ”‘ PUT YOUR FIREBASE INFO HERE
  const firebaseConfig = {
      apiKey: "AIzaSyCnWj14FqC9ejlLSg2-dBIzzzX-NCgGu0Q",
  authDomain: "community-chats-81bc2.firebaseapp.com",
  databaseURL: "https://community-chats-81bc2-default-rtdb.firebaseio.com/",
  projectId: "community-chats-81bc2",
  storageBucket: "community-chats-81bc2.firebasestorage.app",
  messagingSenderId: "699934052199",
  appId: "1:699934052199:web:dd1750734cc14c195b29c2"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  const messagesContainer = document.getElementById('messagesContainer');
  const input = document.getElementById('messageInput');

  // Send message
  function sendMessage() {
      const text = input.value.trim();
      if(!text) return;
      const now = new Date().toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'});
      const messageData = { author:'You', text:text, time:now };
      db.ref('messages').push(messageData);
      input.value = '';
  }

  // Listen for messages
  db.ref('messages').on('child_added', snapshot => {
      const msg = snapshot.val();
      const html = `
        <div class="message ${msg.author==='You'?'own':''}">
            <div class="message-avatar">${msg.author[0]}</div>
            <div class="message-content">
                <div class="message-header">
                    <span class="message-author">${msg.author}</span>
                    <span class="message-time">${msg.time}</span>
                </div>
                <div class="message-bubble">${msg.text}</div>
            </div>
        </div>`;
      messagesContainer.innerHTML += html;
      messagesContainer.scrollTop = messagesContainer.scrollHeight;
  });

  // Rooms
  function switchRoom(room) {
      document.getElementById('roomTitle').textContent = room==='general'?'# General':'# Random';
      messagesContainer.innerHTML = '<div style="text-align:center;padding:40px;color:#999;">No messages yet. Start the conversation!</div>';
  }

  // Online count simulation
  setInterval(() => {
      document.getElementById('onlineCount').textContent = `${Math.floor(Math.random()*20)+100} online`;
  },5000);

</script>
</body>
</html>
